<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home – My App</title>
  <link rel="stylesheet" href="css/style.css">

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    // 1) Initialize Firebase
    const firebaseConfig = {
      apiKey:            "AIzaSyApuSW1IjB5U_9nDuV67ZlPJ8_C8fTOQVk",
      authDomain:        "aeroclubwebsiteapp.firebaseapp.com",
      projectId:         "aeroclubwebsiteapp",
      storageBucket:     "aeroclubwebsiteapp.appspot.com",
      messagingSenderId: "529559179400",
      appId:             "1:529559179400:web:cd1ca2c64a3efcb0970f3d",
      measurementId:     "G-X69J831LCJ"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db   = firebase.firestore();

    // 2) Redirect if not logged in; otherwise check admin role
    auth.onAuthStateChanged(user => {
      if (!user) {
        window.location.href = 'index.html';
        return;
      }

      // Show user email
      document.getElementById('userEmail').textContent = user.email;

      // Look up their role in Firestore
      db.collection('roles').doc(user.uid).get()
        .then(doc => {
          const isAdmin = doc.exists && doc.data().admin === true;
          document.getElementById('adminNav').style.display = isAdmin ? 'inline-block' : 'none';
        })
        .catch(() => {
          // on error, hide admin link
          document.getElementById('adminNav').style.display = 'none';
        });
    });
  </script>
</head>
<body>
  <div class="container">
    <!-- NAVIGATION -->
    <nav>
  <ul>
    <li><a href="home.html">Home</a></li>
    <li><a href="StudentIndex.html">Students</a></li>
    <li><a href="instructors.html">Instructors</a></li>
    <li><a href="flights.html">Flights</a></li>
    <li><a href="aircraft.html">Aircraft</a></li>
    <li id="adminNav" style="display:none;"><a href="admin.html">Admin Panel</a></li>
  </ul>
</nav>

    <!-- MAIN CARD -->
    <div class="card">
      <h1>Welcome to Your Homepage</h1>
      <p>You’re logged in as <strong><span id="userEmail"></span></strong>.</p>
      <button id="logoutBtn">Log Out</button>
    </div>
  </div>

  <script>
    // Log out button
    document.getElementById('logoutBtn').addEventListener('click', () => {
      auth.signOut().then(() => {
        window.location.href = 'index.html';
      });
    });
  </script>
</body>
</html>
